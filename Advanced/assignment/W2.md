# ğŸ“Œ Week 1: ìœˆë„ìš° í•¨ìˆ˜ (Window Functions)

### **âœ… ìœˆë„ìš° í•¨ìˆ˜ (Window Functions) í•™ìŠµ ë° ë¬¸ì œ í’€ì´**

ğŸ“– **ê³µì‹ ë¬¸ì„œ ì •ë¦¬í•˜ê¸°**

- **[ê³µì‹ ë¬¸ì„œ ì •ë¦¬ ë²”ìœ„]: ì•„ë˜ì˜ ìˆœì„œëŒ€ë¡œ ë‚´ìš©ì„ í™•ì¸í•˜ì‹œë©´ ì •ë¦¬ì— ë„ì›€ì´ ë˜ì‹¤ ê²ë‹ˆë‹¤.** ë°˜ë“œì‹œ **ëª¨ë“  ë‚´ìš©ì„ ì •ë¦¬í•  í•„ìš”ëŠ” ì—†ìœ¼ë©°** ë³¸ì¸ì—ê²Œ ë„ì›€ì´ ë  ë§Œí•œ ìƒˆë¡œ ë°°ìš´ ë‚´ìš©ë“¤ì„ ì •ë¦¬í•´ì£¼ì‹œë©´ ì¶©ë¶„í•©ë‹ˆë‹¤.
    - ğŸ”— [MySQL ê³µì‹ ë¬¸ì„œ - 14.20.2. Window Function Concepts and Syntax](https://dev.mysql.com/doc/refman/8.0/en/window-functions-usage.html)
    - ğŸ”— [MySQL ê³µì‹ ë¬¸ì„œ - 14.20.1. Window Function Descriptions](https://dev.mysql.com/doc/refman/8.0/en/window-function-descriptions.html)
    - (ğŸ”— [MySQL ê³µì‹ ë¬¸ì„œ - 14.20.4. Named Windows](https://dev.mysql.com/doc/refman/8.0/en/window-functions-named-windows.html) ) - OPTIONAL
    - ğŸ”— [MySQL ê³µì‹ ë¬¸ì„œ - 14.19.1. Aggregate Function Descriptions](https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html)
        
        â†’ over_clauseë¥¼ ì´ìš©í•˜ì—¬ ì§‘ê³„í•¨ìˆ˜ë¥¼ ìœˆë„ìš°í•¨ìˆ˜ì²˜ëŸ¼ ì‚¬ìš©í•˜ëŠ” ë¶€ë¶„ë§Œ ê³µë¶€í•´ë³´ì„¸ìš”.

#### ê³µì‹ ë¬¸ì„œ ë‚´ìš©

- 14.20.2 Window Function Concepts and Syntax

    ```SQL
    ì§‘ê³„ í•¨ìˆ˜ëŠ” ì¿¼ë¦¬ í–‰ë“¤ì„ í•˜ë‚˜ì˜ ê²°ê³¼ í–‰ìœ¼ë¡œ ê·¸ë£¹í™” í•˜ì§€ë§Œ, 
    WINDOW í•¨ìˆ˜ëŠ” ê° ì¿¼ë¦¬ í–‰ì— ëŒ€í•´ ê²°ê³¼ë¥¼ ìƒì„±í•œë‹¤ëŠ” ì ì—ì„œ ì°¨ì´ê°€ ìˆìŒ 
    ```
    ```SQL
    -- ì˜ˆì‹œ

    SELECT
        year, 
        country, 
        product, 
        profit,
        SUM(profit) OVER() AS total_profit,
        SUM(profit) OVER(PARTITION BY country) AS country_profit
    FROM sales
    ORDER BY 
        country, 
        year, 
        product, 
        profit
    ```
    | year | country | product    | profit | total_profit | country_profit |
    |-|-|-|-|-|-|
    | 2000 | Finland | Computer   |   1500 |         7535 |           1610 |
    | 2000 | Finland | Phone      |    100 |         7535 |           1610 |
    | 2001 | Finland | Phone      |     10 |         7535 |           1610 |
    | 2000 | India   | Calculator |     75 |         7535 |           1350 |
    | 2000 | India   | Calculator |     75 |         7535 |           1350 |
    | 2000 | India   | Computer   |   1200 |         7535 |           1350 |
    | 2000 | USA     | Calculator |     75 |         7535 |           4575 |
    | 2000 | USA     | Computer   |   1500 |         7535 |           4575 |
    | 2001 | USA     | Calculator |     50 |         7535 |           4575 |
    | 2001 | USA     | Computer   |   1200 |         7535 |           4575 |
    | 2001 | USA     | Computer   |   1500 |         7535 |           4575 |
    | 2001 | USA     | TV         |    150 |         7535 |           4575 |
    | 2001 | USA     | TV         |    100 |         7535 |           4575 |
    ```SQL
    OVER():

    1. ë¹ˆ OVER() ì ˆ
    : ì „ì²´ ì¿¼ë¦¬ í–‰ ì§‘í•©ì„ í•˜ë‚˜ì˜ íŒŒí‹°ì…˜ìœ¼ë¡œ ì²˜ë¦¬
    >> ëª¨ë“  í–‰ì— ëŒ€í•´ ì „ì—­ í•©ê³„ë¥¼ ê³„ì‚°
    
    2. PARTITION BY ì ˆ
    : countryë³„ë¡œ ë‚˜ëˆ„ì–´ ê° íŒŒí‹°ì…˜ì— ëŒ€í•œ í•©ê³„ë¥¼ ê³„ì‚°

    WINDOW í•¨ìˆ˜: 
    - **SELECTì™€ ORDER BY ì ˆ**ì—ì„œë§Œ ì‚¬ìš© ê°€ëŠ¥
    - FROM > WHERE > GROUP BY > HAVINGì ˆì„ ì²˜ë¦¬í•œ í›„ WINDOW ì‘ì—…ì´ ì‹¤í–‰ë¨
    - ORDER BY, LIMIT, SELECT DISTINCTë³´ë‹¤ ë¨¼ì € ì‹¤í–‰ë¨
    ```
    ```SQL
    ì§‘ê³„ í•¨ìˆ˜ëŠ” OVER()ì ˆì„ í™œìš©í•˜ì—¬ WINDOW í•¨ìˆ˜ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ

    EX. 
    1. AVG()
    2. BIT_AND()
    3. BIT_OR()
    4. BIT_XOR()
    5. COUNT()
    6. JSON_ARRAYAGG()
    7. JSON_OBJECTAGG()
    8. MAX()
    9. MIN()
    10. STDDEV_POP(), STDDEV(), STD(), STDDEV_SAMP()
    11. SUM()
    12. VAR_POP(), VARIANCE(), VAR_SAMP()

    MYSQLì€ WINDOW í•¨ìˆ˜ë¡œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë¹„ì§‘ê³„ í•¨ìˆ˜ë„ ì§€ì›í•¨

    1. CUME_DIST()
    2. DENSE_RANK()
    3. FIRST_VALUE()
    4. LAG()
    5. LAST_VALUE()
    6. LEAD()
    7. NTH_VALUE()
    8. NTILE()
    9. PERCENT_RANK()
    10. RANK()
    11. ROW_NUMBER()

    ìœ„ í•¨ìˆ˜ë“¤ì€ ë°˜ë“œì‹œ OVER()ì ˆì„ ì‚¬ìš©í•´ì•¼ í•¨

    -- ì˜ˆì‹œ
    SELECT
        year, 
        country, 
        product, 
        profit,
        ROW_NUMBER() OVER(PARTITION BY country) AS row_num1,
        ROW_NUMBER() OVER(PARTITION BY country ORDER BY year, product) AS row_num2
    FROM sales
    ```
    | year | country | product    | profit | row_num1 | row_num2 |
    |-|-|-|-|-|-|
    | 2000 | Finland | Computer   |   1500 |        2 |        1 |
    | 2000 | Finland | Phone      |    100 |        1 |        2 |
    | 2001 | Finland | Phone      |     10 |        3 |        3 |
    | 2000 | India   | Calculator |     75 |        2 |        1 |
    | 2000 | India   | Calculator |     75 |        3 |        2 |
    | 2000 | India   | Computer   |   1200 |        1 |        3 |
    | 2000 | USA     | Calculator |     75 |        5 |        1 |
    | 2000 | USA     | Computer   |   1500 |        4 |        2 |
    | 2001 | USA     | Calculator |     50 |        2 |        3 |
    | 2001 | USA     | Computer   |   1500 |        3 |        4 |
    | 2001 | USA     | Computer   |   1200 |        7 |        5 |
    | 2001 | USA     | TV         |    150 |        1 |        6 |
    | 2001 | USA     | TV         |    100 |        6 |        7 |

- 14.20.1 Window Function Descriptions

    |í•¨ìˆ˜ ì´ë¦„|ì„¤ëª…|
    |-|-|
    |CUME_DIST()|ëˆ„ì  ë¶„í¬ ê°’|
    |DENSE_RANK()|íŒŒí‹°ì…˜ ë‚´ì—ì„œ í˜„ì¬ í–‰ì˜ ìˆœìœ„(ì¤‘ë³µ ê°’ì´ ì—†ëŠ” ê²½ìš°)|
    |FIRST_VALUE()|ìœˆë„ìš° í”„ë ˆì„ì˜ ì²« ë²ˆì§¸ í–‰ì—ì„œì˜ ê°’|
    |LAG()|íŒŒí‹°ì…˜ ë‚´ì—ì„œ í˜„ì¬ í–‰ë³´ë‹¤ ì´ì „ì— ìˆëŠ” í–‰ì˜ ê°’|
    |LAST_VALUE()|ìœˆë„ìš° í”„ë ˆì„ì˜ ë§ˆì§€ë§‰ í–‰ì—ì„œì˜ ê°’|
    |LEAD()|íŒŒí‹°ì…˜ ë‚´ì—ì„œ í˜„ì¬ í–‰ë³´ë‹¤ ì´í›„ì— ìˆëŠ” í–‰ì˜ ê°’|
    |NTH_VALUE()|ìœˆë„ìš° í”„ë ˆì„ì—ì„œ Në²ˆì§¸ í–‰ì˜ ê°’|
    |NTILE()|íŒŒí‹°ì…˜ ë‚´ì—ì„œ í˜„ì¬ í–‰ì˜ ë²„í‚· ë²ˆí˜¸
    |PERCENT_RANK()|ë°±ë¶„ìœ„ ìˆœìœ„ ê°’|
    |RANK()|íŒŒí‹°ì…˜ ë‚´ì—ì„œ í˜„ì¬ í–‰ì˜ ìˆœìœ„(ì¤‘ë³µ ê°’ì´ ìˆëŠ” ê²½ìš°)|
    |ROW_NUMBER()|íŒŒí‹°ì…˜ ë‚´ì—ì„œ í˜„ì¬ í–‰ì˜ ë²ˆí˜¸|

    ```SQL
    1. CUME_DIST() over_clause
    : ì£¼ì–´ì§„ ê°’ì´ í¬í•¨ëœ íŒŒí‹°ì…˜ ë‚´ì—ì„œ ëˆ„ì  ë¶„í¬ë¥¼ ë°˜í™˜
    
    - í˜„ì¬ í–‰ì˜ ê°’ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ì€ ê°’ë“¤ì˜ ë°±ë¶„ìœ¨ì„ ë°˜í™˜í•¨
    - ë²ˆí™˜ ê°’ì€ 0ì—ì„œ 1 ì‚¬ì´
    - ORDER BYì ˆì„ í†µí•´ íŒŒí‹°ì…˜ì˜ í–‰ë“¤ì„ ì›í•˜ëŠ” ìˆœì„œë¡œ ì •ë ¬í•´ì£¼ì–´ì•¼ í•¨
    -> ORDER BYì—†ì´ ì‚¬ìš©í•  ê²½ìš°, ëª¨ë“  í–‰ì´ ë™ë£Œë¡œ ê°„ì£¼ë˜ì–´ N/N = 1ë¡œ ê°’ì´ ë°˜í™˜ë¨

    -- ì˜ˆì‹œ

    SELECT
        val,
        ROW_NUMBER() OVER w AS 'row_number',
        CUME_DIST() OVER w AS 'cume_dist',
        PERCENT_RANK() OVER w AS 'percent_rank'
    FROM numbers
    WINDOW w AS (ORDER BY val);
    ```
    | val  | row_number | cume_dist          | percent_rank |
    |-|-|-|-|
    |    1 |          1 | 0.2222222222222222 |            0 |
    |    1 |          2 | 0.2222222222222222 |            0 |
    |    2 |          3 | 0.3333333333333333 |         0.25 |
    |    3 |          4 | 0.6666666666666666 |        0.375 |
    |    3 |          5 | 0.6666666666666666 |        0.375 |
    |    3 |          6 | 0.6666666666666666 |        0.375 |
    |    4 |          7 | 0.8888888888888888 |         0.75 |
    |    4 |          8 | 0.8888888888888888 |         0.75 |
    |    5 |          9 |                  1 |            1 |

    ```SQL
    2. DENSE_RANK() over_clause
    : íŒŒí‹°ì…˜ ë‚´ì—ì„œ í˜„ì¬ í–‰ì˜ ìˆœìœ„ë¥¼ ë°˜í™˜

    - ì¤‘ë³µëœ ê°’ì´ ìˆë”ë¼ë„ ê·¸ ë‹¤ìŒ ê°’ì€ ì¤‘ë³µëœ ê°’ ìˆ˜ë§Œí¼ ìˆœìœ„ê°€ ë°€ë¦¬ì§€ ì•Šê³  ì—°ì†ì ìœ¼ë¡œ ì¦ê°€ë¨
    ```
    ```SQL
    3. FIRST_VALUE(expr) [null_treatment] over_clause
    : WINDOW FRAME exprì˜ ì²« ë²ˆì§¸ í–‰ ê°’ì„ ë°˜í™˜

    -- ì˜ˆì‹œ

    SELECT
        time, 
        subject, 
        val,
        FIRST_VALUE(val)  OVER w AS 'first',
        LAST_VALUE(val)   OVER w AS 'last',
        NTH_VALUE(val, 2) OVER w AS 'second',
        NTH_VALUE(val, 4) OVER w AS 'fourth'
    FROM observations
    WINDOW w AS (PARTITION BY subject ORDER BY time ROWS UNBOUNDED PRECEDING)
    ```
    | time     | subject | val  | first | last | second | fourth |
    |-|-|-|-|-|-|-|
    | 07:00:00 | st113   |   10 |    10 |   10 |   NULL |   NULL |
    | 07:15:00 | st113   |    9 |    10 |    9 |      9 |   NULL |
    | 07:30:00 | st113   |   25 |    10 |   25 |      9 |   NULL |
    | 07:45:00 | st113   |   20 |    10 |   20 |      9 |     20 |
    | 07:00:00 | xh458   |    0 |     0 |    0 |   NULL |   NULL |
    | 07:15:00 | xh458   |   10 |     0 |   10 |     10 |   NULL |
    | 07:30:00 | xh458   |    5 |     0 |    5 |     10 |   NULL |
    | 07:45:00 | xh458   |   30 |     0 |   30 |     10 |     30 |
    | 08:00:00 | xh458   |   25 |     0 |   25 |     10 |     30 |
    
    ```SQL
    4. LAG(expr [, N[, default]]) [null_treatment] over_clause
    : í˜„ì¬ í–‰ì„ ê¸°ì¤€ìœ¼ë¡œ Nê°œì˜ í–‰ ì•ì„œ ìˆëŠ” í–‰ì˜ expr ê°’ì„ ë°˜í™˜

    - ë§Œì•½ ê·¸ëŸ° í–‰ì´ ì—†ë‹¤ë©´ default ê°’ì„ ë°˜í™˜
    - Nì€ ë¹„ìŒìˆ˜ ì •ìˆ˜ì—¬ì•¼ í•˜ê³ , ê¸°ë³¸ê°’ì€ 1
    
    -- ì˜ˆì‹œ

    SELECT
        t, 
        val,
        LAG(val) OVER w AS 'lag',
        LEAD(val) OVER w AS 'lead',
        val - LAG(val) OVER w AS 'lag diff',
        val - LEAD(val) OVER w AS 'lead diff'
    FROM series
    WINDOW w AS (ORDER BY t)
    ```
    | t        | val  | lag  | lead | lag diff | lead diff |
    |-|-|-|-|-|-|
    | 12:00:00 |  100 | NULL |  125 |     NULL |       -25 |
    | 13:00:00 |  125 |  100 |  132 |       25 |        -7 |
    | 14:00:00 |  132 |  125 |  145 |        7 |       -13 |
    | 15:00:00 |  145 |  132 |  140 |       13 |         5 |
    | 16:00:00 |  140 |  145 |  150 |       -5 |       -10 |
    | 17:00:00 |  150 |  140 |  200 |       10 |       -50 |
    | 18:00:00 |  200 |  150 | NULL |       50 |      NULL |

    ```SQL
    LAG()ì™€ LEAD()ëŠ” ì°¨ì´ë¿ë§Œ ì•„ë‹ˆë¼ í•©ì„ ê³„ì‚°í•˜ëŠ” ë°ì—ë„ ì‚¬ìš© ê°€ëŠ¥ëŠ¥

    SELECT
        n,
        LAG(n, 1, 0)      OVER w AS 'lag',
        LEAD(n, 1, 0)     OVER w AS 'lead',
        n + LAG(n, 1, 0)  OVER w AS 'next_n',
        n + LEAD(n, 1, 0) OVER w AS 'next_next_n'
    FROM fib
    WINDOW w AS (ORDER BY n)
    ```
    | n    | lag  | lead | next_n | next_next_n |
    |-|-|-|-|-|
    |    1 |    0 |    1 |      1 |           2 |
    |    1 |    1 |    2 |      2 |           3 |
    |    2 |    1 |    3 |      3 |           5 |
    |    3 |    2 |    5 |      5 |           8 |
    |    5 |    3 |    8 |      8 |          13 |
    |    8 |    5 |    0 |     13 |           8 |

    ```SQL
    5. LAST_VALUE(expr) [null_treatment] over_clause
    : WINDOW FRAME exprì˜ ë§ˆì§€ë§‰ í–‰ ê°’ì„ ë°˜í™˜
    ```

    ```SQL
    6. NTH_VALUE(expr, N) [from_first_last] [null_treatment] over_clause
    : WINDOW FRAME exprì˜ Në²ˆì§¸ í–‰ ê°’ì„ ë°˜í™˜

    - MYSQLì—ì„œëŠ” FROM FIRSTë§Œ í—ˆìš©ë¨
    - FROM LASTì™€ ë™ì¼í•œ íš¨ê³¼ë¥¼ ì–»ìœ¼ë ¤ë©´ ORDER BYë¥¼ ì‚¬ìš©í•´ ì—­ìˆœìœ¼ë¡œ ì •ë ¬í•´ì•¼ í•¨
    ```
    ```SQL
    7. NTILE(N) over_clause
    : íŒŒí‹°ì…˜ì„ Nê°œì˜ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ  ê° í–‰ì— ê·¸ë£¹ ë²ˆí˜¸ë¥¼ í• ë‹¹í•´, í˜„ì¬ í–‰ì˜ ê·¸ë£¹ ë²ˆí˜¸ë¥¼ ë°˜í™˜

    - ORDER BYê³¼ í•¨ê»˜ ì‚¬ìš©í•˜ì—¬ íŒŒí‹°ì…˜ í–‰ì„ ì›í•˜ëŠ” ìˆœì„œë¡œ ì •ë ¬í•´ì•¼ í•¨

    -- ì˜ˆì‹œ

    SELECT
        val,
        ROW_NUMBER() OVER w AS 'row_number',
        NTILE(2)     OVER w AS 'ntile2',
        NTILE(4)     OVER w AS 'ntile4'
    FROM numbers
    WINDOW w AS (ORDER BY val)
    ```
    | val  | row_number | ntile2 | ntile4 |
    |-|-|-|-|
    |    1 |          1 |      1 |      1 |
    |    1 |          2 |      1 |      1 |
    |    2 |          3 |      1 |      1 |
    |    3 |          4 |      1 |      2 |
    |    3 |          5 |      1 |      2 |
    |    3 |          6 |      2 |      3 |
    |    4 |          7 |      2 |      3 |
    |    4 |          8 |      2 |      4 |
    |    5 |          9 |      2 |      4 |

    ```SQL
    8. PERCENT_RANK() over_clause
    : í˜„ì¬ í–‰ì˜ ê°’ë³´ë‹¤ ì‘ì€ ê°’ì´ íŒŒí‹°ì…˜ ë‚´ì—ì„œ ì°¨ì§€í•˜ëŠ” ë¹„ìœ¨ì„ ë°˜í™˜

    - ìµœëŒ“ê°’ì€ ì œì™¸í•˜ê³  ê³„ì‚°ë¨
    - ë°˜í™˜ ê°’ì€ 0ì—ì„œ 1 ì‚¬ì´
    - ORDER BYê³¼ í•¨ê»˜ ì‚¬ìš©í•˜ì—¬ íŒŒí‹°ì…˜ í–‰ì„ ì›í•˜ëŠ” ìˆœì„œë¡œ ì •ë ¬í•´ì•¼ í•¨

    ê³µì‹: PERCENT_RANK = (rank - 1) / (rows - 1)
    ```

    ```SQL
    9. RANK() over_clause
    : íŒŒí‹°ì…˜ ë‚´ì—ì„œ í˜„ì¬ í–‰ì˜ ìˆœìœ„ë¥¼ ë°˜í™˜

    - ê°’ì´ ê°™ìœ¼ë©´ ë™ì¼í•œ ìˆœìœ„ë¥¼ ë¶€ì—¬ë°›ì§€ë§Œ, ê·¸ í›„ì˜ ìˆœìœ„ëŠ” ê°’ì´ ê°™ì€ ê°œìˆ˜ë§Œí¼ ê±´ë„ˆë›°ì–´ì„œ ë¶€ì—¬ë¨
    - ORDER BYê³¼ í•¨ê»˜ ì‚¬ìš©í•˜ì—¬ íŒŒí‹°ì…˜ í–‰ì„ ì›í•˜ëŠ” ìˆœì„œë¡œ ì •ë ¬í•´ì•¼ í•¨
    ```
---

### ğŸ“ **ë¬¸ì œ í’€ì´**:

ğŸ”— [LeetCode - Rank Scores](https://leetcode.com/problems/rank-scores/description/) `DENSE_RANK()`

ğŸ“ë¬¸ì œ ë‚´ìš©

Write a solution to find the rank of the scores. The ranking should be calculated according to the following rules:

- The scores should be ranked from the highest to the lowest.
If there is a tie between two scores, both should have the same ranking.
- After a tie, the next ranking number should be the next consecutive integer value. In other words, there should be no holes between ranks.

Return the result table ordered by score in descending order.

The result format is in the following example.

ğŸ“ë¬¸ì œ í’€ì´

```SQL
SELECT
    score,
    DENSE_RANK() OVER(ORDER BY score DESC) AS `rank`
FROM Scores
ORDER BY
    score DESC
```

---

ğŸ”— [Solvesql - ë‹¤ìŒë‚ ë„ ì„œìš¸ìˆ²ì˜ ë¯¸ì„¸ë¨¼ì§€ ë†ë„ëŠ” ë‚˜ì¨ ğŸ˜¢](https://solvesql.com/problems/bad-finedust-measure/) `LEAD()`

ğŸ“ë¬¸ì œ ë‚´ìš©

`measurements` í…Œì´ë¸”ì˜ `pm10` ì»¬ëŸ¼ì—ëŠ” ë‹¤ì–‘í•œ ëŒ€ê¸°ì˜¤ì—¼ë„ ì¸¡ì • ê¸°ì¤€ ì¤‘ì—ì„œë„ ë¯¸ì„¸ë¨¼ì§€(PM10) ë†ë„ê°€ ê¸°ë¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ ë°ì´í„°ë¥¼ ì´ìš©í•˜ì—¬ ë‹¹ì¼ì˜ ë¯¸ì„¸ë¨¼ì§€ ë†ë„ë³´ë‹¤ ë°”ë¡œ ë‹¤ìŒë‚ ì˜ ë¯¸ì„¸ë¨¼ì§€ ë†ë„ê°€ ë” ì•ˆì¢‹ì€ ë‚ ì„ ì°¾ì•„ì£¼ì„¸ìš”. ê²°ê³¼ëŠ” ì•„ë˜ ì»¬ëŸ¼ë“¤ì„ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.

- `today`: ë‹¹ì¼ (YYYY-MM-DD)
- `next_day`: ë‹¤ìŒë‚  (YYYY-MM-DD)
- `pm10`: ë‹¹ì¼ì˜ ë¯¸ì„¸ë¨¼ì§€ ë†ë„
- `next_pm10`: ë‹¤ìŒë‚ ì˜ ë¯¸ì„¸ë¨¼ì§€ ë†ë„

ğŸ“ë¬¸ì œ í’€ì´

```SQL
SELECT
  *
FROM(
    SELECT
        measured_at AS today,
        LEAD(measured_at) OVER() AS next_day,
        pm10,
        LEAD(pm10) OVER() AS next_pm10
    FROM measurements) AS INFO
WHERE
  pm10 < next_pm10
```

---

ğŸ”— [programmers - ê·¸ë£¹ë³„ ì¡°ê±´ì— ë§ëŠ” ì‹ë‹¹ ëª©ë¡ ì¶œë ¥í•˜ê¸°](https://school.programmers.co.kr/learn/courses/30/lessons/131124) (ë„ì „!!)
    
    â†’ ë¬¸ì œë¥¼ í‘¸ëŠ” ë‹¤ì–‘í•œ ë°©ì‹ì´ ìˆì§€ë§Œ, **ìœˆë„ìš° í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬** í•´ê²°í•˜ëŠ” ë°©ì‹ì— ëŒ€í•´ ê³ ë¯¼í•´ ë³´ì‹œê¸¸ ë°”ëë‹ˆë‹¤.
    
    *DATE í˜•ì‹ì„ ë¬¸ì œì˜ ì¡°ê±´ì— ë§ê²Œ ì‘ì„±í•´ì£¼ì–´ì•¼ í†µê³¼ë˜ë¯€ë¡œ, DATE_FORMATì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”~

ğŸ“ë¬¸ì œ ë‚´ìš©

`MEMBER_PROFILE`ì™€ `REST_REVIEW` í…Œì´ë¸”ì—ì„œ ë¦¬ë·°ë¥¼ ê°€ì¥ ë§ì´ ì‘ì„±í•œ íšŒì›ì˜ ë¦¬ë·°ë“¤ì„ ì¡°íšŒí•˜ëŠ” SQLë¬¸ì„ ì‘ì„±í•´ì£¼ì„¸ìš”. íšŒì› ì´ë¦„, ë¦¬ë·° í…ìŠ¤íŠ¸, ë¦¬ë·° ì‘ì„±ì¼ì´ ì¶œë ¥ë˜ë„ë¡ ì‘ì„±í•´ì£¼ì‹œê³ , ê²°ê³¼ëŠ” ë¦¬ë·° ì‘ì„±ì¼ì„ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœ, ë¦¬ë·° ì‘ì„±ì¼ì´ ê°™ë‹¤ë©´ ë¦¬ë·° í…ìŠ¤íŠ¸ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬í•´ì£¼ì„¸ìš”.

ğŸ“ë¬¸ì œ í’€ì´

```SQL
WITH A AS
(SELECT
    MEMBER_ID,
    REVIEW_TEXT,
    DATE_FORMAT(REVIEW_DATE, '%Y-%m-%d') AS REVIEW_DATE,
    COUNT(MEMBER_ID) OVER (PARTITION BY MEMBER_ID) AS COUNT
FROM REST_REVIEW)
SELECT
    MEMBER_NAME,
    REVIEW_TEXT,
    REVIEW_DATE
FROM A
JOIN MEMBER_PROFILE AS MP
USING(MEMBER_ID)
WHERE
    COUNT = (
    SELECT
        MAX(COUNT)
    FROM A)
ORDER BY
    REVIEW_DATE ASC,
    REVIEW_TEXT ASC
```
